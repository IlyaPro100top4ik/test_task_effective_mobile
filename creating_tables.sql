/*Задание 1: Абитуриенты
Есть таблица examination с двумя полями: id (id абитуриента), scores (кол-во набранных баллов дополнительного вступительного испытания от 0 до 100).
Требуется реализовать запрос, который создаёт колонку с позицией абитуриента в общем рейтинге.*/

-- Создание таблицы для примера
CREATE TABLE examination (
    id INT PRIMARY KEY,
    scores INT CHECK (scores BETWEEN 0 AND 100)
);

-- Вставка тестовых данных
INSERT INTO examination (id, scores) VALUES
(1, 85),
(2, 92),
(3, 78),
(4, 92),
(5, 88),
(6, 95),
(7, 78),
(8, 85),
(9, 91),
(10, 77);


/*Задание 2: FULL JOIN
Представьте две таблицы: первая содержит 30 строк, а вторая — 20 строк. Мы выполняем операцию FULL JOIN между ними.
Какой диапазон возможного количества строк может быть в результирующей таблице, если учесть, что ключи для соединения могут быть 
как полностью совпадающими, так и абсолютно уникальными?


Ответ дать в краткой форме, например: минимально 30 и максимально 50 строк*/

create table account
(
    id integer, -- ID счета
    client_id integer, -- ID клиента
    open_dt date, -- дата открытия счета
    close_dt date -- дата закрытия счета
);

create table transaction
(
    id integer,  -- ID транзакции
    account_id integer,  -- ID счета
    transaction_date date,  -- дата транзакции
    amount numeric(10,2), -- сумма транзакции
    type varchar(3) -- тип транзакции
);

-- Тестовые данные
INSERT INTO account (id, client_id, open_dt, close_dt) VALUES
(1, 100, '2020-01-01', NULL),        -- Активный счёт
(2, 100, '2021-06-01', '2023-12-31'), -- Закрытый счёт
(3, 200, '2022-03-15', NULL),        -- Активный счёт
(4, 300, '2021-01-01', NULL);        -- Активный счёт

INSERT INTO transaction (id, account_id, transaction_date, amount, type) VALUES
-- Клиент 100 (сумма покупок за последний месяц = 4500)
(1, 1, CURRENT_DATE - 10, 2000.00, 'PUR'),
(2, 1, CURRENT_DATE - 5, 2500.00, 'PUR'),
-- Клиент 200 (сумма = 6000 > 5000)
(3, 3, CURRENT_DATE - 15, 6000.00, 'PUR'),
-- Клиент 300 (нет покупок за последний месяц)
(4, 4, CURRENT_DATE - 40, 10000.00, 'PUR'); 

